---
# Containment for recursive parent child and sibling relationship. One of the pattern MIB for this
# containment applied is Entity MIB.
# Created by David Chan, 2014-07-17

name: ciscoPhysicalContainment
signatures:
      - name: Vendor
        operator: Equal
        value: cisco

snmpContainment:
      containmentType: EntityMib
      serviceElementTypeName: ciscoSystem
      snmpLevels:
        - name: entityParentChild
          contextOID: entPhysicalEntry
          parentChildRelationship:
             containmentOid: entPhysicalContainedIn
             siblingOid: entPhysicalParentRelPos
             subTypeOid: entPhysicalVendorType
             modelOid: entPhysicalModelName
             softwareVersionOid: entPhysicalSoftwareRev
 
        - name: portInterfaceMapping
          category: port
          contextOID: ifEntry 
          descriminatorOID: cdpInterfaceEnable
          globalDescriminatorOID: cdpGlobalRun
          containmentRelationship:
            mappingContext: ifEntry
            mappingTable: entAliasMappingEntry
            mappingOid: entAliasMappingIdentifier
            mappingType: FullOid
          disriminators:
             - serviceElementTypeName: interface
               globaldiscriminatorValue: false
               discriminatorValue: false
             - serviceElementTypeName: interface
               globaldiscriminatorValue: true
               discriminatorValue: false
             - serviceElementTypeName: cdpInterface
               globaldiscriminatorValue: true
               discriminatorValue: true
          children:
             - name: cdpCacheMapping
               contextOID: cdpCacheEntry
               disriminators:
                  - serviceElementTypeName: cdpCache
             - name: interfaceIpAddress
               contextOID: ipAddrEntry
               containmentRelationship: 
                  mappingTable: ipAddrEntry
                  mappingOid: ipAdEntIfIndex
                  mappingType: InstanceOnly
               disriminators:
                  - serviceElementTypeName: ipv4Address  
                                                  
        - name: cdpGlobalLevel
          category: System
          contextOID: cdpGlobalRun
          disriminators:
             - serviceElementTypeName: cdpGlobal
